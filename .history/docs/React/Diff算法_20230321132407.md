看完这篇文章，我们可以弄明白下面这几个问题：

1. `React` 为什么要做 `diff` 算法？
2. `React` 的 `diff` 算法是怎么实现的？
3. `React` 的 `diff` 算法发生在哪个阶段？
4. `React` 的元素的 `key` 是做什么的？
5. `React` 是怎么通过 `key` 实现高效 `diff` 的？

## Fiber 节点的构建

```js
// 被拆分成的一个一个单元的小任务
let nextUnitOfWork = null

function workLoop(deadline) {
  // requestIdleCallback 给 shouldYield 赋值，告诉我们浏览器是否空闲
  let shouldYield = false
  while (nextUnitOfWork && !shouldYield) {
    nextUnitOfWork = performUnitOfWork(nextUnitOfWork)
    shouldYield = deadline.timeRemaining() < 1
  }
  // 循环调用 workLoop
  requestIdleCallback(workLoop)
}

requestIdleCallback(workLoop)

// 构建完当前 fiber 节点后，会返回下一个待构建的节点
function performUnitOfWork(nextUnitOfWork) {
  // TODO
}
```